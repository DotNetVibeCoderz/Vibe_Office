<Window xmlns="https://github.com/avaloniaui"
        xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml"
        xmlns:vm="using:SharepointExplorer.ViewModels"
        xmlns:models="using:SharepointExplorer.Models"
        x:Class="SharepointExplorer.Views.MainWindow"
        x:DataType="vm:MainWindowViewModel"
        Title="SharePoint Explorer"
        Width="1000" Height="700"
        WindowStartupLocation="CenterScreen">

  <DockPanel>
    <Menu DockPanel.Dock="Top">
      <MenuItem Header="_File">
        <MenuItem Header="Open Site" Command="{Binding RefreshCommand}"/>
        <Separator/>
        <MenuItem Header="E_xit" Click="Exit_Click"/>
      </MenuItem>
      <MenuItem Header="_New">
        <MenuItem Header="New Folder" Command="{Binding CreateFolderCommand}" CommandParameter="New Folder"/>
        <MenuItem Header="New Document">
            <MenuItem Header="Text Document" Command="{Binding NewDocumentCommand}" CommandParameter="Text"/>
            <MenuItem Header="Word Document" Command="{Binding NewDocumentCommand}" CommandParameter="Word"/>
            <MenuItem Header="Excel Spreadsheet" Command="{Binding NewDocumentCommand}" CommandParameter="Excel"/>
            <MenuItem Header="PowerPoint Presentation" Command="{Binding NewDocumentCommand}" CommandParameter="PowerPoint"/>
        </MenuItem>
      </MenuItem>
      <MenuItem Header="_Help">
        <MenuItem Header="About" Click="About_Click"/>
      </MenuItem>
    </Menu>

    <Grid ColumnDefinitions="250, 4, *">
      <!-- Left Pane: Navigation Tree -->
      <TreeView Grid.Column="0" ItemsSource="{Binding NavigationItems}" SelectedItem="{Binding SelectedNavigationItem}">
        <TreeView.ItemTemplate>
          <TreeDataTemplate ItemsSource="{Binding Children}">
            <TextBlock Text="{Binding Name}"/>
          </TreeDataTemplate>
        </TreeView.ItemTemplate>
        <TreeView.ContextMenu>
             <ContextMenu>
                <MenuItem Header="Refresh" Command="{Binding RefreshCommand}"/>
             </ContextMenu>
        </TreeView.ContextMenu>
      </TreeView>
      
      <GridSplitter Grid.Column="1" ResizeDirection="Columns"/>

      <!-- Right Pane: File Grid -->
      <DataGrid Grid.Column="2" ItemsSource="{Binding CurrentFolderItems}"
                AutoGenerateColumns="False" IsReadOnly="True"
                SelectionMode="Extended"
                SelectionChanged="DataGrid_SelectionChanged"
                DoubleTapped="DataGrid_DoubleTapped">
        <DataGrid.ContextMenu>
            <ContextMenu>
                <MenuItem Header="Download" Command="{Binding DownloadCommand}"/>
                <MenuItem Header="Delete" Command="{Binding DeleteCommand}"/>
                <!-- Rename and Properties would go here -->
            </ContextMenu>
        </DataGrid.ContextMenu>
        <DataGrid.Columns>
           <DataGridTextColumn Header="Name" Binding="{Binding Name}" Width="2*"/>
           <DataGridTextColumn Header="Type" Binding="{Binding TypeDisplay}" Width="*"/>
           <DataGridTextColumn Header="Modified" Binding="{Binding LastModified}" Width="1.5*"/>
           <DataGridTextColumn Header="Size" Binding="{Binding Size}" Width="*"/>
        </DataGrid.Columns>
      </DataGrid>
    </Grid>
  </DockPanel>
</Window>